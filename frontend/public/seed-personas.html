<!DOCTYPE html>
<html>
<head>
    <title>Seed Personas</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        #log { background: #f0f0f0; padding: 10px; white-space: pre-wrap; max-height: 500px; overflow-y: auto; }
        .success { color: green; }
        .error { color: red; }
        button { padding: 10px 20px; font-size: 16px; margin: 10px 0; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Seed Personas</h1>
    <button onclick="seedPersonas()">Create Sample Personas</button>
    <div id="log"></div>
    
    <script>
        const API_BASE = 'http://localhost:8000';
        const logEl = document.getElementById('log');
        
        function log(msg, isError = false) {
            const line = document.createElement('div');
            line.className = isError ? 'error' : 'success';
            line.textContent = msg;
            logEl.appendChild(line);
            logEl.scrollTop = logEl.scrollHeight;
        }
        
        async function seedPersonas() {
            log('Starting persona seeding...');
            
            const personas = [
                // Global personas (no brand)
                { name: "Maria Santos", age: 52, gender: "Female", condition: "Type 2 Diabetes", region: "Miami, Florida",
                  motivations: ["Stay healthy for grandchildren"], beliefs: ["Diet is key"], pain_points: ["Cost of meds"] },
                { name: "Robert Chen", age: 45, gender: "Male", condition: "Hypertension", region: "Seattle, Washington",
                  motivations: ["Prevent cardiovascular events"], beliefs: ["Data-driven health"], pain_points: ["Remembering meds"] },
                { name: "Dr. Angela Morrison", age: 58, gender: "Female", condition: "Type 2 Diabetes", region: "Chicago, Illinois",
                  motivations: ["Optimal glycemic control"], beliefs: ["Personalized medicine"], pain_points: ["Prior auth delays"] },
                // Mounjaro personas (brand_id = 1)
                { name: "Jennifer Williams", age: 48, gender: "Female", condition: "Type 2 Diabetes", region: "Austin, Texas",
                  brand_id: 1, motivations: ["Achieve remission"], beliefs: ["GLP-1 breakthrough"], pain_points: ["GI side effects"] },
                { name: "Michael Thompson", age: 55, gender: "Male", condition: "Type 2 Diabetes", region: "Phoenix, Arizona",
                  brand_id: 1, motivations: ["Avoid insulin"], beliefs: ["Results matter"], pain_points: ["Insurance hassle"] },
                { name: "Dr. David Park", age: 42, gender: "Male", condition: "Type 2 Diabetes", region: "San Diego, California",
                  brand_id: 1, motivations: ["Modern treatments"], beliefs: ["Dual mechanism efficacy"], pain_points: ["Cost barriers"] },
                { name: "Sarah Mitchell", age: 62, gender: "Female", condition: "Type 2 Diabetes", region: "Denver, Colorado",
                  brand_id: 1, motivations: ["Stay active"], beliefs: ["Once-weekly is better"], pain_points: ["Medicare coverage"] },
            ];
            
            let successCount = 0;
            let errorCount = 0;
            
            for (const persona of personas) {
                try {
                    const response = await fetch(`${API_BASE}/personas/manual`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(persona)
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        const brandInfo = persona.brand_id ? `Mounjaro (brand_id=${persona.brand_id})` : 'Global';
                        log(`✓ Created: ${result.name} - ${brandInfo}`);
                        successCount++;
                    } else {
                        const error = await response.text();
                        log(`✗ Failed to create ${persona.name}: ${response.status} - ${error}`, true);
                        errorCount++;
                    }
                } catch (e) {
                    log(`✗ Error creating ${persona.name}: ${e.message}`, true);
                    errorCount++;
                }
            }
            
            log('');
            log(`Seeding complete: ${successCount} created, ${errorCount} failed`);
            
            // Verify
            try {
                const resp = await fetch(`${API_BASE}/personas/`);
                const allPersonas = await resp.json();
                log(`Total personas in database: ${allPersonas.length}`);
            } catch (e) {
                log(`Error checking total: ${e.message}`, true);
            }
        }
    </script>
</body>
</html>








